const MAX = require('../index')
const max = new MAX({ accessKey: 'cy7HrS7d8FAP4QKounU1lTDXAjwT9OBMnlX6IKqx', secretKey: 'HjhZv5Y8oxzcCUEaAm4kmCiznxuxuOY62XlTdg0e' })

const ws = max.ws()

ws.open().then(() => {
  console.log('resolve')
}).catch((error) => {
  console.log(error)
})

ws.on('open', () => {
  console.log('websocket connected')

  ws.subscribeTicker('ethtwdt')
})

ws.on('message', (message) => {
  console.log(message)

  if (message.info === 'ticker') {
    // ws.unsubscribeTicker('ethtwdt')
    // ws.close()
  }

  if (message.info === 'unsubscribed') {
    ws.close()
  }
})

ws.on('challenged', () => {
  ws.subscribeAccount()
})

ws.on('authenticated', () => {
  ws.unsubscribeAccount()
})

ws.on('ticker', (msg) => {
  console.log(msg)
})
